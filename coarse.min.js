export default class Coarse{constructor(e,{renderControls:t=!0,renderDots:s=!0,hookAttribute:i='data-coarse',selectedClass:r='selected',swipeSensitivity:a=.1,align:l='center',wrap:n=!0}={}){let o,d='next',c='previous',u='coarse-controls',p=`.${u}.${d}`,g=`.${u}.${c}`,m=!1,h=0,b=[],f=Array.from(e.children),$=f.length,A=e.querySelector(`.${r}`),w=e.parentElement,y=e=>`slide ${e+1} of ${$}`,L=e=>parseFloat(e.replace('px','')),v=(e,t)=>L(getComputedStyle(e)[t]),x=e=>e.target.closest(`[${i}]`),E=(e,t,s=window)=>s.addEventListener(e,t),S=e=>{o=parseFloat(e),f.map((t,s)=>t.classList.toggle(r,s==e)),b.map((t,s)=>t.classList.toggle(r,s==e))},q=e=>{let t=e.changedTouches?e.changedTouches[0]:e;m=!0,h=t.clientX},C=e=>{if(!m)return;let t=(e.changedTouches?e.changedTouches[0]:e).clientX-h;t<100*a-100&&T(o+1),t>100-100*a&&T(o-1)},T=s=>{m=!1;let r=s==$,a=s<0;if((a||r)&&!n)return;a?s=$-1:r&&(s=0);let d=f[s],c=w.querySelector(p),u=w.querySelector(g),h=v(d,'width'),b=v(d,'marginLeft'),A=v(d,'marginRight'),L=v(w,'width')-v(w,'paddingLeft')-v(w,'paddingRight'),x=v(e,'width'),E=s*(h+b+A),q=-1*b;/center/i.test(l)&&(q=.5*(L-h-A-A)),/right/i.test(l)&&(q=L-h-A),n||(c.disabled=!1,u.disabled=!1,s<=0&&(u.disabled=!0),s==$-1&&(c.disabled=!0)),S(s);let C=(E-q)/x;if(e.style.transform=`translate3d(${-100*C}%, 0, 0)`,t){let e=o+1;c.setAttribute(i,e),c.title=`Go to ${y(e==$?0:e)}`;let t=o-1;u.setAttribute(i,t),u.title=`Go to ${y(o?t:$-1)}`}};if(t&&[c,d].map((e,t)=>{let s=document.createElement('button');s.title=e,s.classList.add(u,e),s.setAttribute(i,o+(t||-1)),w.append(s)}),s){let e=document.createElement('div');e.classList.add('coarse-dot-navigation'),f.map((t,s)=>{let r=document.createElement('button');r.title=`Jump to ${y(s)}`,r.setAttribute(i,s),b.push(r),e.append(r)}),w.append(e)}T(A?f.indexOf(A):0),f.map((e,t)=>e.setAttribute(i,t)),E('resize',()=>requestAnimationFrame(()=>T(o))),E('focusin',e=>{let t=x(e);f.indexOf(t)>-1&&T(t.getAttribute(i))},w),E('click',e=>{let t=x(e);t&&T(t.getAttribute(i))},w),a>0&&(E('mousedown',q,w),E('touchstart',q,w),E('mouseup',C,w),E('touchend',C,w))}}